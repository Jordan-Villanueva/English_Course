<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Learning Platform</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #166088;
            --accent: #4cb5f5;
            --light: #f8f9fa;
            --dark: #343a40;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --hover-shadow: 0 8px 16px rgba(0,0,0,0.12);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        /* Header mejorado */
        .main-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
	.header-buttons {
	  display: flex;
	  justify-content: center;
	  gap: 10px;
	  margin-top: 15px;
	  flex-wrap: wrap;
	}

	.header-buttons button {
	  padding: 10px 20px;
	  background-color: rgba(255,255,255,0.2);
	  color: white;
	  border: 1px solid white;
	  border-radius: 12px;
	  cursor: pointer;
	  transition: all 0.4s ease;
	}

	.header-buttons button:hover {
	  background-color: rgba(255,255,255,0.35);
	  transform: translateY(-2px) scale(1.05);
	}
        
        .user-progress {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 20px;
        }
        
        .xp-bar {
            width: 120px;
            height: 12px;
            background: rgba(255,255,255,0.3);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .xp-progress {
            height: 100%;
            background: var(--accent);
            border-radius: 6px;
            font-size: 0.7rem;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            padding: 0 5px;
        }
        
        .streak-counter, .coins {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
        }
        
        /* Navegaci√≥n de lecciones */
        .lessons-nav {
            background: white;
            padding: 10px;
            border-bottom: 1px solid #ddd;
            display: flex;
            overflow-x: auto;
            gap: 5px;
        }
        
        .lesson-chip {
            padding: 5px 15px;
            border-radius: 20px;
            background: #e9ecef;
            font-size: 0.9rem;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .lesson-chip.current {
            background: var(--primary);
            color: white;
        }
        
        .lesson-chip.completed {
            background: var(--success);
            color: white;
        }
        
        .lesson-chip:hover {
            transform: translateY(-2px);
        }
        
        /* Contenido principal */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            padding: 20px 0;
            flex: 1;
        }
        
        .lesson-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        /* Barra lateral de progreso */
        .progress-sidebar {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            height: fit-content;
            position: sticky;
            top: 90px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--light);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .community-activity {
            margin-top: 20px;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .activity-item img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }
        
        /* Elementos de lecci√≥n */
        .lesson-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .lesson-section:hover {
            box-shadow: var(--hover-shadow);
        }
        
        .title-flex {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .title-flex .translatable {
    	    flex: 1; /* Ocupa el espacio disponible */
	}
        
        .objetivos ul {
            padding-left: 20px;In
        }
        
	.objetivos li {
	    display: flex;
	    align-items: center;
	    gap: 10px;
	}

	.objetivos li .translatable {
	    flex: 1;
	}
        
        /* Elementos interactivos */
        .interactive-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .word-card {
            background-color: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .word-card:hover, .number-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--hover-shadow);
        }
        
                /* CONTENEDOR DE IMAGEN - CLAVE PARA EL AJUSTE */
	.word-card-image {
	  width: 100px;   /* contenedor cuadrado */
	  height: 100px;
	  display: flex;
	  justify-content: center;
	  align-items: center;
	  overflow: hidden; /* evita que se salga */
	}

	.word-card-image img {
	  max-width: 100%;
	  max-height: 100%;
	  object-fit: contain; /* asegura que la imagen quepa completa */
	  border-radius: 6px;
	  display: block;
	}

        
        /* Efecto de zoom suave al pasar el rat√≥n */
        .word-card:hover .word-card-image img {
            transform: scale(1.05);
        }
        
        .word-card-content {
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            justify-content: space-between;
        }
        
        .word-card-text {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .object-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .object-item {
            position: relative;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .object-item:hover {
            border-color: var(--accent);
            box-shadow: 0 5px 15px rgba(76, 181, 245, 0.2);
        }
        
        .object-image {
            max-width: 100%;
            height: 60px;
            object-fit: contain;
            margin-bottom: 8px;
        }
        
        /* Botones */
        button {
            cursor: pointer;
            border: none;
            border-radius: 5px;
            padding: 8px 12px;
            background: var(--light);
            transition: background 0.2s, transform 0.2s;
        }
        
        button:hover {
            background: #e2e6ea;
            transform: translateY(-2px);
        }
        
        .speak-btn {
            background: var(--accent);
            color: white;
        }
        
        .speak-btn:hover {
            background: #3aa0d9;
        }
        
        .big-btn {
            display: inline-block;
            padding: 12px 20px;
            margin: 5px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 8px;
        }
        
        /* Quiz */
        .quiz-item {
            margin-bottom: 20px;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
            transition: transform 0.3s;
        }
        
        .quiz-item:hover {
            transform: translateY(-3px);
        }
        
        .matching-grid {
            display: flex;
            gap: 15px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        
        /* Responsive */
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .progress-sidebar {
                position: static;
                margin-bottom: 20px;
                order: -1;
            }
        }
        
        @media (max-width: 600px) {
            .header-content {
                flex-direction: column;
                gap: 10px;
            }
            
            .interactive-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .title-flex {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        
	@media (max-width:768px) {
	  .header-buttons { flex-direction:column; align-items:center; }
	  .header-buttons button { width:80%; margin-bottom:10px; }
	}
        
        /* Animaciones */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1s infinite;
        }
        
        @keyframes celebrate {
            0% { transform: translateY(0); }
            25% { transform: translateY(-5px); }
            50% { transform: translateY(0); }
            75% { transform: translateY(-3px); }
            100% { transform: translateY(0); }
        }
        
        .celebrate {
            animation: celebrate 0.5s ease;
        }
        
        /* Efectos de finalizaci√≥n */
        .completed-checkmark {
            color: var(--success);
            margin-left: 5px;
        }
        
        /* Mejoras visuales para iframes */
        iframe {
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            margin: 10px 0;
        }
        
        /* Estilo para n√∫meros */
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        
        .number-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }
        
        .number {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .number-name {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        /* Mejoras para el mapa */
        #map {
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            z-index: 1;
        }
        
        /* Mejoras para la secci√≥n de juego */
        .game-item {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            transition: transform 0.3s;
        }
        
        .game-item:hover {
            transform: translateY(-3px);
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            background: var(--dark);
            color: white;
        }
        
        /* Modo oscuro */
        .dark-mode {
            --light: #2d2d2d;
            background-color: #1a1a1a;
            color: #f0f0f0;
        }
        
        .dark-mode .lesson-section, 
        .dark-mode .progress-sidebar,
        .dark-mode .game-item,
        .dark-mode .quiz-item,
        .dark-mode .word-card,
        .dark-mode .number-item,
        .dark-mode .stat-card {
            background: #2d2d2d;
            color: #f0f0f0;
        }
        
        .dark-mode .lessons-nav {
            background: #2d2d2d;
            border-bottom: 1px solid #444;
        }
        
        .dark-mode .lesson-chip {
            background: #3d3d3d;
            color: #f0f0f0;
        }
        
        .dark-mode button {
            background: #3d3d3d;
            color: #f0f0f0;
        }
        
        .dark-mode .object-item {
            background: #2d2d2d;
            border-color: #444;
        }
    </style>
</head>
<body>
	<header class="main-header">
	    <div class="container">
		<div class="header-content">
		    <h1><i class="fas fa-language"></i> English Learning Platform</h1>
		    <div class="user-progress">
		        <div class="xp-bar">
		            <div class="xp-progress" style="width: 30%;">150/500 XP</div>
		        </div>
		        <div class="streak-counter"><i class="fas fa-fire"></i> 3 d√≠as</div>
		        <div class="coins"><i class="fas fa-coins"></i> 75</div>
		        <button id="theme-toggle"><i class="fas fa-moon"></i></button>
		    </div>
		</div>
		
	<div class="header-buttons">
	    <button id="login-btn">Login/Ingresar</button>
	    <button id="logout-btn">Logout/Salir</button>
	    <button id="home-btn">üè† Home/Inicio</button>
	</div>
	    </div>
	</header>
    
    <nav class="lessons-nav">
        <div class="container">
            <div class="lesson-chip completed"><i class="fas fa-check-circle"></i> Class 1</div>
            <div class="lesson-chip completed"><i class="fas fa-check-circle"></i> Class 2</div>
            <div class="lesson-chip current"><i class="fas fa-play-circle"></i> Class 3</div>
            <div class="lesson-chip"><i class="fas fa-lock"></i> Class 4</div>
            <div class="lesson-chip"><i class="fas fa-lock"></i> Class 5</div>
            <div class="lesson-chip"><i class="fas fa-lock"></i> Class 6</div>
        </div>
    </nav>
    
    <div class="container">
        <div class="main-content">
            <div class="lesson-content">
                <section class="lesson-section objetivos" data-translated="false">
                    <h2 class="title-flex">
                        <span id="introduction" class="translatable" data-original="Class 1: Introductions, greetings and farewells. Numbers, pronouns and countries" data-translation="Clase 1: Presentaciones, saludos y despedidas. N√∫meros, pronombres y pa√≠ses">Class 1: Introductions, greetings and farewells. Numbers, pronouns and countries</span>
                    <button class="translate-section-btn">üåê</button>
                    <button onclick="speak(document.getElementById('introduction').dataset.original)">üîä</button> 
                    </h2>
                    <p class="subtitle">
                        <span id="beginners" class="translatable" data-original="English Course for Beginners" data-translation="Curso de Ingl√©s para principiantes">English Course for Beginners</span>
                        <button onclick="speak(document.getElementById('beginners').dataset.original)">üîä</button>
                    </p>
                </section>

                <section class="lesson-section objetivos" data-translated="false">
            <h2 class="title-flex">
                <span id="objectives" class="translatable" data-original="üéØ Class objectives" data-translation="üéØ Objetivos de la clase">üéØ Class objectives 
                </span>
                <button class="translate-section-btn">üåê</button>
                <button onclick="speak('Class objectives')">üîä</button> 
            </h2>
            <ul>
                <li>
                    <span id="objectives-desc1" class="translatable" data-original="Students will be able to introduce themselves, greet, say goodbye and use basic courtesy phrases." data-translation="Los estudiantes podr√°n presentarse, saludar, despedirse y usar frases b√°sicas de cortes√≠a.">Students will be able to introduce themselves, greet, say goodbye and use basic courtesy phrases.</span>
                    <button onclick="speak(document.getElementById('objectives-desc1').dataset.original)">üîä</button>
                </li>
                <li>
                    <span id="objectives-desc2" class="translatable" data-original="Start speaking and writing in English at a very basic level." data-translation="Comenzar a hablar y escribir en ingl√©s a un nivel muy b√°sico.">Start speaking and writing in English at a very basic level.</span>
                    <button onclick="speak(document.getElementById('objectives-desc2').dataset.original)">üîä</button>
                </li>
                <li>
                    <span id="objectives-desc3" class="translatable" data-original="Learn basic vocabulary including numbers, pronouns and countries." data-translation="Aprender vocabulario b√°sico incluyendo n√∫meros, pronombres y pa√≠ses.">Learn basic vocabulary including numbers, pronouns and countries.</span>
                    <button onclick="speak(document.getElementById('objectives-desc3').dataset.original)">üîä</button>
                </li>
                <li>
                    <span id="objectives-desc4" class="translatable" data-original="Practice listening comprehension through videos and songs." data-translation="Practicar comprensi√≥n auditiva mediante videos y canciones.">Practice listening comprehension through videos and songs.</span>
                    <button onclick="speak(document.getElementById('objectives-desc4').dataset.original)">üîä</button>
                </li>
            </ul>
        </section>

                <!-- Warm-up -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="warmup-title" class="translatable" data-original="1. Warm-up / Icebreaker (10 min)" data-translation="1. Calentamiento / Rompehielos (10 min)">1. Warm-up / Icebreaker (10 min) </span>
                    <button class="translate-section-btn">üåê</button>
                        <button onclick="speak('1. Warm-up / Icebreaker')">üîä</button>
                    </h2>
                    <p>
                        <span id="warm-desc1" class="translatable" data-original="Hello, my name is Jordan. I'm from Mexico. I'm a physicist and software developer and I love movies and teaching." data-translation="Hola, mi nombre es Jordan. Soy de M√©xico. Soy f√≠sico y desarrollador de software, y me encantan las pel√≠culas y la ense√±anza.">Hello, my name is Jordan. I'm from Mexico. I'm a physicist and software developer and I love movies and teaching.</span>
                        <button onclick="speak(document.getElementById('warm-desc1').dataset.original)">üîä</button>
                    </p>
                    <p><em>
                        <span id="warm-desc2" class="translatable" data-original="Greeting: What's your name? Where are you from? What do you like and what do you do?" data-translation="Saludo: ¬øC√≥mo te llamas? ¬øDe d√≥nde eres? ¬øQu√© te gusta y a qu√© te dedicas?">Greeting: What's your name? Where are you from? What do you like and what do you do?</span>
                    </em>
                        <button onclick="speak('Greeting: Whats your name? Where are you from? What do you like and what do you do?')">üîä</button>
                    </p>
                </section>

                <!-- Secci√≥n 2: Vocabulary and pronouns con im√°genes -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="vocabulary" class="translatable" data-original="2. Vocabulary and pronouns (15 min)" data-translation="2. Vocabulario y pronombres (15 min)">2. Vocabulary and pronouns (10 min) </span>
                     <button class="translate-section-btn">üåê</button>
                        <button onclick="speak('2. Vocabulary and pronouns')">üîä</button> 
                    </h2>
                    
                    <h3 class="title-flex">
                        <span id="greetings" class="translatable" data-original="Greetings" data-translation="Saludos">Greetings <button onclick="speak(document.getElementById('greetings').dataset.original)">üîä</button> </span>
                    </h3>
                    
                    <div class="interactive-grid">
                        <div class="word-card" onclick="speak('Hello')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/Hello.jpg" alt="Hello">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Hello" data-translation="Hola">Hello</div>
                                
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('Hi')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/Hi.png" alt="Hi">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Hi" data-translation="Hola">Hi</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('Good morning')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/good_morning.jpg" alt="Good morning">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Good morning" data-translation="Buen d√≠a">Good morning</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('Good afternoon')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/good_afternoon.jpg" alt="Good afternoon">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Good afternoon" data-translation="Buena tarde">Good afternoon</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('Good evening')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/good_evening.jpg" alt="Good evening">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Good evening" data-translation="Buena noche">Good evening</div>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="title-flex">
                        <span id="farew" class="translatable" data-original="Farewells" data-translation="Despedidas">Farewells <button onclick="speak(document.getElementById('farew').dataset.original)">üîä</button></span>
                    </h3>
                    
                    <div class="interactive-grid">
                        <div class="word-card" onclick="speak('Good night')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/Good_night.jpg" alt="Good night">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Good night" data-translation="Buena noche">Good night</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('Goodbye')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/Goodbye.jpg" alt="Goodbye">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Goodbye" data-translation="Adi√≥s">Goodbye</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('Bye')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/bye.jpg" alt="Bye">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="Bye" data-translation="Adi√≥s">Bye</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('See you')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/see_you.png" alt="See you">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="See you" data-translation="Nos vemos">See you</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('See you later')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/see_you_later.jpg" alt="See you later">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="See you later" data-translation="Hasta luego">See you later</div>
                            </div>
                        </div>
                    </div>
                    
                    <h3 class="title-flex">
                        <span id="title-pronouns" class="translatable" data-original="Personal pronouns + verb 'To be'" data-translation="Pronombres personales + verbo 'Ser/Estar'">Personal pronouns + verb "To be" <button onclick="speak(document.getElementById('title-pronouns').dataset.original)">üîä</button></span>
                    </h3>
                    
                    <div class="interactive-grid">
                        <div class="word-card" onclick="speak('I am')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/iam.png" alt="I am">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="I am" data-translation="Yo soy/estoy">I am</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('You are')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/youare.jpg" alt="You are">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="You are" data-translation="T√∫ eres/est√°s">You are</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('He is')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/heis.png" alt="He is">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="He is" data-translation="√âl es/est√°">He is</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('She is')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/sheis.png" alt="She is">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="She is" data-translation="Ella es/est√°">She is</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('We are')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/weare.jpg" alt="We are">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="We are" data-translation="Nosotros somos/estamos">We are</div>
                            </div>
                        </div>
                        
                        <div class="word-card" onclick="speak('They are')">
                            <div class="word-card-image">
                                <img src="images/greetings_farewells/theyare.jpg" alt="They are">
                            </div>
                            <div class="word-card-content">
                                <div class="word-card-text translatable" data-original="They are" data-translation="Ellos son/est√°n">They are</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Listening / Modeled videos -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="title-listening" class="translatable" data-original="3. Listening / Modeling: Conversation and Cinema (10 min)" data-translation="3. Escucha / Modelado: Conversaci√≥n y Cine (10 min)">3. Listening / Modeling: Conversation and Cinema (10 min)
                        </span>
                        <button class="translate-section-btn">üåê</button>
                        <button onclick="speak('3. Listening / Modeling: Conversation and Cinema')">üîä</button>
                    </h2>
                    <p>
                        <span id="listen-instr" class="translatable" data-original="Watch the conversation video and write key sentences. Then, in the movie clips video, identify the learned phrases:" data-translation="Mira el video de conversaci√≥n y escribe las frases clave. Luego, en el video de clips de pel√≠culas, identifica las frases aprendidas:">Watch the conversation video and write key sentences. Then, in the movie clips video, identify the learned phrases:</span>
                        <button onclick="speak(document.getElementById('listen-instr').dataset.original)">üîä</button>
                    </p>
                    <iframe width="100%" height="315" src="https://www.youtube.com/embed/RL8pLS8cUOs" frameborder="0" allowfullscreen style="margin-bottom: 15px;"></iframe>
                    <iframe width="100%" height="315" src="https://www.youtube.com/embed/ImOoyoLmGUI" frameborder="0" allowfullscreen></iframe>
                </section>

                <!-- Song practice -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="title-song" class="translatable" data-original="4. Song Practice (10 min)" data-translation="4. Pr√°ctica de canci√≥n (10 min)">4. Song Practice (10 min)
                        </span>
                        <button class="translate-section-btn">üåê</button>
                        <button onclick="speak('4. Song Practice')">üîä</button> 
                    </h2>
                    <p>
                        <span id="song-instr" class="translatable" data-original="Listen to the song and complete the lyrics playing on LyricsTraining:" data-translation="Escucha la canci√≥n y completa la letra en LyricsTraining:">Listen to the song and complete the lyrics playing on LyricsTraining:</span>
                        <button onclick="speak(document.getElementById('song-instr').dataset.original)">üîä</button>
                    </p>
                    <button class="speak-btn lyrics-btn" onclick="window.open('https://es.lyricstraining.com/play/the-beatles/hello-goodbye/HkEvrcQWdk#b7w!jortizvilla','_blank')">
                        <span id="song-btn" class="translatable" data-original="üéµ Play with the song on LyricsTraining" data-translation="üéµ Juega con la canci√≥n en LyricsTraining">üéµ Play with the song on LyricsTraining</span>
                    </button>
                </section>

                <!-- Secci√≥n 5: Where are you from? -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="title-where" class="translatable" data-original='5. Introduction of "Where are you from?" (10 min)' data-translation='5. Introducci√≥n de "¬øDe d√≥nde eres?" (10 min)'>
                            5. Introduction of "Where are you from?" (10 min)
                        </span>
                        <button class="translate-section-btn">üåê</button>
                        <button onclick="speak('5. Introduction of Where are you from?')">üîä</button>
                    </h2>

                    <!-- Video -->
                    <p>
                        <span id="where-instr" class="translatable" data-original="Watch the video" data-translation="Mira el video">
                            Watch the video
                        </span>
                        <button onclick="speak(document.getElementById('where-instr').dataset.original)">üîä</button>
                    </p>
                    <iframe width="100%" height="315" src="https://www.youtube.com/embed/byqOkm6-SCc" frameborder="0" allowfullscreen></iframe>

                    <!-- Map con audio -->
                    <p>
                        <span id="map-instr" class="translatable" data-original="Select a country on the map!" data-translation="¬°Selecciona un pa√≠s en el mapa!">
                            Select a country on the map!
                        </span>
                        <button onclick="speak(document.getElementById('map-instr').dataset.original)">üîä</button>
                    </p>
                    <div id="map" style="height: 400px; width: 100%;"></div>
                    <p id="dialogue"></p>
                </section>

                <!-- Secci√≥n 6: What's this? -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="interactive-title-6" class="translatable"
                              data-original="6. Interactive Practice: &quot;What's this?&quot;"
                              data-translation="6. Pr√°ctica interactiva: &quot;¬øQu√© es esto?&quot;">
                            6. Interactive Practice: "What's this?" (10 min)
                        </span>
                        <button class="translate-section-btn" type="button">üåê</button>
                        <button type="button" onclick="speak('6. Interactive Practice: What‚Äôs this?')">üîä</button>
                    </h2>

                    <p>
                        <span id="interactive-desc-6" class="translatable"
                              data-original="Click on the objects to hear their names in English. Then practice asking &quot;What's this?&quot;"
                              data-translation="Haz clic en los objetos para escuchar sus nombres en ingl√©s. Luego practica preguntando &quot;¬øQu√© es esto?&quot;">
                            Click on the objects to hear their names in English. Then practice asking "What's this?"
                        </span>
                        <button type="button" onclick="speak(document.getElementById('interactive-desc-6').dataset.original)">üîä</button>
                    </p>

                    <div class="object-container">
                        <!-- Book -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/book-solid-full.svg" 
                                class="object-image" alt="Book">
                            <span class="object-name translatable" 
                                data-original="Book" 
                                data-translation="Libro">???</span>
                        </div>

                        <!-- Pen -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/pen-clip-solid-full.svg" 
                                class="object-image" alt="Pen">
                            <span class="object-name translatable" 
                                data-original="Pen" 
                                data-translation="Bol√≠grafo">???</span>
                        </div>

                        <!-- Pencil -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/pencil-solid-full.svg" 
                                class="object-image" alt="Pencil">
                            <span class="object-name translatable" 
                                data-original="Pencil" 
                                data-translation="L√°piz‚Äã">???</span>
                        </div>

                        <!-- Chair -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/chair-solid-full.svg" 
                                class="object-image" alt="Chair">
                            <span class="object-name translatable" 
                                data-original="Chair" 
                                data-translation="Silla">???</span>
                        </div>

                        <!-- Table -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/table-furniture.svg" 
                                class="object-image" alt="Table">
                            <span class="object-name translatable" 
                                data-original="Table" 
                                data-translation="Mesa">???</span>
                        </div>

                        <!-- Bag -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/bag-personal.svg" 
                                class="object-image" alt="Bag">
                            <span class="object-name translatable" 
                                data-original="Bag" 
                                data-translation="Bolsa">???</span>
                        </div>

                        <!-- Clock -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/clock-time-seven-outline.svg" 
                                class="object-image" alt="Clock">
                            <span class="object-name translatable" 
                                data-original="Clock" 
                                data-translation="Reloj">???</span>
                        </div>

                        <!-- Notebook -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/notebook.svg" 
                                class="object-image" alt="Notebook">
                            <span class="object-name translatable" 
                                data-original="Notebook" 
                                data-translation="Libreta">???</span>
                        </div>

                        <!-- Marker -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/marker.svg" 
                                class="object-image" alt="Marker">
                            <span class="object-name translatable" 
                                data-original="Marker" 
                                data-translation="Marcador">???</span>
                        </div>

                        <!-- Eraser -->
                        <div class="object-item" onclick="flipCard(this)">
                            <img src="https://raw.githubusercontent.com/Jordan-Villanueva/English_Course/main/Class1/images/eraser-solid-full.svg" 
                                class="object-image" alt="Eraser">
                            <span class="object-name translatable" 
                                data-original="Eraser" 
                                data-translation="Borrador">???</span>
                        </div>
                    </div>
                </section>

                <!-- Numbers -->
                <section class="lesson-section" data-translated="false">
                  <h2 class="title-flex">
                    <span id="numbers-title" class="translatable"
                          data-original="7. Numbers in English: from 1 to 30"
                          data-translation="7. N√∫meros en ingl√©s: del 1 al 30">
                      7. Numbers in English: from 1 to 30 (10 min)
                    </span>
                    <button class="translate-section-btn">üåê</button>
                    <button onclick="speak(document.getElementById('numbers-title').dataset.original)">üîä</button>
                  </h2>

                  <p>
                    <span id="numbers-desc" class="translatable"
                          data-original="Click each number to hear its pronunciation:"
                          data-translation="Haz clic en cada n√∫mero para escuchar su pronunciaci√≥n:">
                      Click each number to hear its pronunciation:
                    </span>
                    <button onclick="speak(document.getElementById('numbers-desc').dataset.original)">üîä</button>
                  </p>

                  <div class="numbers-grid">
                     <script>
		      const numberGrid = document.currentScript.parentNode;
		      const numbers = [
			{ en: "one", es: "uno" }, { en: "two", es: "dos" }, { en: "three", es: "tres" }, 
			{ en: "four", es: "cuatro" }, { en: "five", es: "cinco" }, { en: "six", es: "seis" },
			{ en: "seven", es: "siete" }, { en: "eight", es: "ocho" }, { en: "nine", es: "nueve" },
			{ en: "ten", es: "diez" }, { en: "eleven", es: "once" }, { en: "twelve", es: "doce" },
			{ en: "thirteen", es: "trece" }, { en: "fourteen", es: "catorce" }, { en: "fifteen", es: "quince" },
			{ en: "sixteen", es: "diecis√©is" }, { en: "seventeen", es: "diecisiete" }, { en: "eighteen", es: "dieciocho" },
			{ en: "nineteen", es: "diecinueve" }, { en: "twenty", es: "veinte" }, { en: "twenty-one", es: "veintiuno" },
			{ en: "twenty-two", es: "veintid√≥s" }, { en: "twenty-three", es: "veintitr√©s" },
			{ en: "twenty-four", es: "veinticuatro" }, { en: "twenty-five", es: "veinticinco" },
			{ en: "twenty-six", es: "veintis√©is" }, { en: "twenty-seven", es: "veintisiete" },
			{ en: "twenty-eight", es: "veintiocho" }, { en: "twenty-nine", es: "veintinueve" },
			{ en: "thirty", es: "treinta" }
		      ];

		      for (let i = 0; i < numbers.length; i++) {
			const div = document.createElement('div');
			div.className = 'number-item';

			// Texto traducible
			const numberName = document.createElement('span');
			numberName.className = 'number-name translatable';
			numberName.dataset.original = numbers[i].en;
			numberName.dataset.translation = numbers[i].es;
			numberName.dataset.tts = numbers[i].en;
			numberName.textContent = numbers[i].en; // solo texto

			// Bot√≥n de bocina separado
			const speakerBtn = document.createElement('button');
			// speakerBtn.textContent = "üîä";
			speakerBtn.onclick = function(e) {
			  e.stopPropagation(); // evitar que el div padre tambi√©n haga speak
			  speak(numberName.dataset.tts);
			};

			div.innerHTML = `<div class="number">${i+1}</div>`;
			div.appendChild(numberName);
		       // div.appendChild(speakerBtn);

			// Click en div completo tambi√©n reproduce audio
			div.onclick = function() {
			  speak(numberName.dataset.tts);
			};

			numberGrid.appendChild(div);
		      }
		    </script>
                  </div>

                  <div class="practice-block">
                    <p><strong>
                      <span class="translatable"
                            data-original="Pronunciation practice:"
                            data-translation="Pr√°ctica de pronunciaci√≥n:">
                        Pronunciation practice:
                      </span>
                      <button type="button" onclick="speak('Pronunciation practice')">üîä</button>
                    </strong></p>

                   <!-- Secci√≥n de Listen 1-30 -->
                <button class="speak-btn big-btn" onclick="practiceNumbers(1,10)">
                  <span class="translatable" data-original="Listen 1 to 10" data-translation="Escuchar del 1 al 10">
                    Listen 1 to 10
                  </span>
                </button>

                <button class="speak-btn big-btn" onclick="practiceNumbers(11,20)">
                  <span class="translatable" data-original="Listen 11 to 20" data-translation="Escuchar del 11 al 20">
                    Listen 11 to 20
                  </span>
                </button>

                <button class="speak-btn big-btn" onclick="practiceNumbers(21,30)">
                  <span class="translatable" data-original="Listen 21 to 30" data-translation="Escuchar del 21 al 30">
                    Listen 21 to 30
                  </span>
                </button>
                  </div>
                </section>

                <!-- Secci√≥n 8: Mini writing -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="interactive-title-8" class="translatable" data-original="8. Mini writing / journaling (10 min)" data-translation="8. Escritura / Diario personal (10 min)">
                            8. Mini writing / journaling (10 min)
                        </span>
                        <button class="translate-section-btn">üåê</button>
                        <button type="button" onclick="speak('8. Mini writing / journaling')">üîä</button>
                    </h2>
                    <ul>
                        <li>
                            <span id="mini-write-1" class="translatable" data-original="Hello, my name is ___" data-translation="Hola, mi nombre es ___">Hello, my name is ___.</span>
                            <button type="button" onclick="speak('Hello, my name is')">üîä</button>
                        </li>
                        <li>
                            <span id="mini-write-2" class="translatable" data-original="I'm from ___" data-translation="Soy de ___">I'm from ___.</span>
                            <button type="button" onclick="speak('I'm from')">üîä</button>
                        </li>
                        <li>
                            <span id="mini-write-3" class="translatable" data-original="I like ___" data-translation="Me gusta ___">I like ___.</span>
                            <button type="button" onclick="speak('I like')">üîä</button>
                        </li>
                    </ul>
                </section>

                <!-- Secci√≥n 9: Group speaking -->
                <section class="lesson-section" data-translated="false">
                    <h2 class="title-flex">
                        <span id="interactive-title-9" class="translatable" data-original="9. Group speaking (10 min)" data-translation="9. Conversaci√≥n grupal (10 min)">
                            9. Group speaking (10 min)
                        </span>
                        <button class="translate-section-btn">üåê</button>
                        <button type="button" onclick="speak('9. Group speaking')">üîä</button>
                    </h2>
                    <p>
                        <span id="group-desc" class="translatable" data-original="The students practice to introduce themselves in groups using the learned phrases, including the questions" 
                              data-translation="Los estudiantes practican presentarse en grupos usando las frases aprendidas, incluyendo las preguntas">
                            The students practice to introduce themselves in groups using the learned phrases, including the questions
                        </span> 
                        <button type="button" onclick="speak(document.getElementById('group-desc').dataset.original)">üîä</button>
                    </p>
                </section>

                <!-- Secci√≥n de finalizaci√≥n -->
                <section class="lesson-section">
                    <h2>‚úÖ Complete this lesson</h2>
                    <p>Finish all activities and take the quiz to complete this lesson and earn 50 XP!</p>
                    <button class="big-btn speak-btn" onclick="completeLesson()">Mark as Complete</button>
                </section>
            </div>
            
            <div class="progress-sidebar">
                <h3><i class="fas fa-chart-line"></i> Your Progress</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>Words Learned</h4>
                        <p class="stat-number">42</p>
                    </div>
                    <div class="stat-card">
                        <h4>Streak</h4>
                        <p class="stat-number">3 days</p>
                    </div>
                    <div class="stat-card">
                        <h4>Lessons</h4>
                        <p class="stat-number">2/10</p>
                    </div>
                    <div class="stat-card">
                        <h4>Accuracy</h4>
                        <p class="stat-number">87%</p>
                    </div>
                </div>
                
                <div class="daily-goal">
                    <h4>üéØ Daily Goal</h4>
                    <div class="xp-bar">
                        <div class="xp-progress" style="width: 65%;">13/20 points</div>
                    </div>
                </div>
                
                <div class="community-activity">
                    <h4><i class="fas fa-users"></i> Community Activity</h4>
                    <div class="activity-item">
                        <img src="https://i.pravatar.cc/40?img=1" alt="User">
                        <p><strong>Maria</strong> completed Greetings lesson</p>
                    </div>
                    <div class="activity-item">
                        <img src="https://i.pravatar.cc/40?img=2" alt="User">
                        <p><strong>John</strong> earned 100 XP</p>
                    </div>
                    <div class="activity-item">
                        <img src="https://i.pravatar.cc/40?img=3" alt="User">
                        <p><strong>Sophia</strong> is on a 7-day streak!</p>
                    </div>
                </div>
                
                <button class="big-btn" style="margin-top: 15px; width: 100%;"><i class="fas fa-handshake"></i> Find Practice Partners</button>
            </div>
        </div>
    </div>

    <footer>
        <p>English Course for Beginners ‚Äî Created by Jordan Ortiz</p>
    </footer>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>

// Esperar a que el DOM est√© listo
document.addEventListener('DOMContentLoaded', function() {
    // Inicializar los botones
    const loginBtn = document.getElementById('login-btn');
    const logoutBtn = document.getElementById('logout-btn');
    const homeBtn = document.getElementById('home-btn');
    
    // Funci√≥n para redirigir al home
    function goHome() {
        window.location.href = 'https://elegant-frangipane-efce46.netlify.app/';
    }
    
    // Asignar evento al bot√≥n home
    if (homeBtn) {
        homeBtn.addEventListener('click', goHome);
    }
    
    // Verificar si auth.js ya est√° cargado y tiene las funciones
    function checkAuthLoaded() {
        if (typeof window.showLoggedOut === 'function' && 
            typeof window.showContent === 'function') {
            // Auth.js est√° cargado, actualizar UI seg√∫n estado
            if (localStorage.getItem('access_token')) {
                // Usuario logueado
                if (loginBtn) loginBtn.style.display = 'none';
                if (logoutBtn) logoutBtn.style.display = 'block';
                if (homeBtn) homeBtn.style.display = 'block';
            } else {
                // Usuario no logueado
                if (loginBtn) loginBtn.style.display = 'block';
                if (logoutBtn) logoutBtn.style.display = 'none';
                if (homeBtn) homeBtn.style.display = 'none';
            }
            return true;
        }
        return false;
    }
    
    // Intentar verificar si auth.js est√° cargado
    if (!checkAuthLoaded()) {
        // Si no est√° cargado a√∫n, esperar un poco y reintentar
        setTimeout(checkAuthLoaded, 500);
    }
    
    // Si estamos en una p√°gina de clase (no en el index principal)
    // y el usuario no est√° autenticado, mostrar mensaje
    const isClassPage = window.location.pathname.includes('Class');
    if (isClassPage && !localStorage.getItem('access_token')) {
        const mainContent = document.querySelector('.main-content');
        if (mainContent) {
            mainContent.innerHTML = `
                <div style="text-align: center; padding: 40px;">
                    <h2>Authentication Required</h2>
                    <p>Please log in to access this class content.</p>
                    <button id="goto-login" style="padding: 10px 20px; background: var(--primary); color: white; border: none; border-radius: 5px;">
                        Go to Login
                    </button>
                </div>
            `;
            
            document.getElementById('goto-login').addEventListener('click', function() {
                window.location.href = 'https://elegant-frangipane-efce46.netlify.app/';
            });
        }
    }
});

/* ------------------------
  Texto a voz (TTS) mejorado
------------------------ */
function preprocessTextForTTS(text) {
  const hacks = {
    "I'm": "I\u200Bm", "I'm.": "I\u200Bm.", "I'm,": "I\u200Bm,",
    "It's": "It\u200Bs", "What's": "What\u200Bs", "That's": "That\u200Bs",
    "There's": "There\u200Bs", "Here's": "Here\u200Bs",
    "You're": "You\u200Bre", "We're": "We\u200Bre", "They're": "They\u200Bre",
    "He's": "He\u200Bs", "She's": "She\u200Bs"
  };
  let processed = text;
  for(const [k,v] of Object.entries(hacks)) processed = processed.replace(new RegExp(k, "gi"), v);
  return processed;
}

function speak(text, lang = 'en-US') {
  if (!('speechSynthesis' in window)) return;
  window.speechSynthesis.cancel();
  const utterance = new SpeechSynthesisUtterance(preprocessTextForTTS(text));
  utterance.lang = lang;
  utterance.rate = 0.95; utterance.pitch = 1.2; utterance.volume = 1;
  const voices = speechSynthesis.getVoices();
  utterance.voice = voices.find(v => ['Google US English','Microsoft Zira Desktop - English (United States)','Samantha'].includes(v.name)) || voices[0];
  window.speechSynthesis.speak(utterance);
}
window.speechSynthesis.onvoiceschanged = () => speechSynthesis.getVoices();

/* ------------------------
  Flip cards y traducci√≥n
------------------------ */
function flipCard(card) {
  const wordSpan = card.querySelector(".object-name");
  const isTranslated = card.closest("section").getAttribute("data-translated") === "true";
  if (wordSpan.textContent === "???") {
    wordSpan.textContent = isTranslated ? wordSpan.dataset.translation : wordSpan.dataset.original;
    wordSpan.dataset.revealed = "true";
  } else {
    wordSpan.textContent = "???";
    wordSpan.dataset.revealed = "false";
  }
  speak(wordSpan.dataset.original);
}

document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll(".translate-section-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      const container = btn.closest("[data-translated]");
      const isTranslated = container.getAttribute("data-translated") === "true";
      container.querySelectorAll(".translatable").forEach(el => {
        if(el.classList.contains("object-name") && el.dataset.revealed==="true"){
          el.textContent = isTranslated ? el.dataset.original : el.dataset.translation;
        } else if (!el.classList.contains("object-name")){
          el.textContent = isTranslated ? el.dataset.original : el.dataset.translation;
        }
      });
      container.setAttribute("data-translated", !isTranslated);
    });
  });
});

/* ------------------------
  Drag & Drop y quiz
------------------------ */
const draggables = document.querySelectorAll('.draggable');
const objectItems = document.querySelectorAll('.object-item');

draggables.forEach(d => d.addEventListener('dragstart', e=> e.dataTransfer.setData('text', e.target.id)));
objectItems.forEach(item=>{
  item.addEventListener('dragover', e=> e.preventDefault());
  item.addEventListener('drop', e=>{
    e.preventDefault();
    const id = e.dataTransfer.getData('text');
    const word = document.getElementById(id);
    if(word.textContent === item.dataset.answer){
      item.appendChild(word);
      item.style.border = "2px solid green";
    } else alert('Try again!');
  });
});

function checkQuiz() {
  let score=0;
  const answers={q1:'b', q2:'a', q3:'b', q4:'a'};
  for(const q in answers){
    const radios=document.getElementsByName(q);
    for(const r of radios) if(r.checked && r.value===answers[q]) score++;
  }
  let dragScore=0;
  objectItems.forEach(item=>{
    const word=item.querySelector('.draggable');
    if(word && word.textContent===item.dataset.answer) dragScore++;
  });
  const totalScore = score + dragScore;
  document.getElementById('quiz-result').textContent = `You scored ${totalScore}/7 üéâ`;
  speak(`You scored ${totalScore} out of 7`);
}

/* ------------------------
  Lecci√≥n completada
------------------------ */
function completeLesson(){
  const btn=document.querySelector('.complete-lesson-btn');
  alert('Lesson completed! +50 XP');
  btn.classList.add('pulse');
  setTimeout(()=>{
    btn.classList.remove('pulse');
    btn.textContent='Completed ‚úì';
    btn.style.background='var(--success)';
  },1000);
}

/* ------------------------
  Sistema de repetici√≥n espaciada
------------------------ */
const learningItems = {};
function scheduleReview(itemId, difficulty) {
  if (!learningItems[itemId]) learningItems[itemId] = { interval: 1, ease: 2.5, dueDate: new Date() };
  const item = learningItems[itemId];
  const factors = { again: 1.2, hard: 1.5, good: 2.0, easy: 2.5 };
  item.interval = Math.round(item.interval * factors[difficulty]);
  item.dueDate = new Date(Date.now() + item.interval * 86400000);
  console.log(`Item ${itemId} scheduled for review in ${item.interval} days`);
  return item.dueDate;
}

/* ------------------------
  Celebraciones y modo oscuro
------------------------ */
document.querySelectorAll('.word-card, .number-item').forEach(item=>{
  item.addEventListener('click', ()=>{ 
    item.classList.add('celebrate');
    setTimeout(()=>item.classList.remove('celebrate'),500);
  });
});

document.getElementById('theme-toggle')?.addEventListener('click', ()=>{
  document.body.classList.toggle('dark-mode');
  const icon=document.querySelector('#theme-toggle i');
  icon?.classList.toggle('fa-sun', document.body.classList.contains('dark-mode'));
  icon?.classList.toggle('fa-moon', !document.body.classList.contains('dark-mode'));
});

/* ------------------------
  Mapa de pa√≠ses con di√°logos
------------------------ */
const map = L.map('map').setView([20,0],2);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  maxZoom:5, attribution:'&copy; OpenStreetMap contributors'
}).addTo(map);

  // Lista de pa√≠ses con di√°logos y traducci√≥n
  const countries = [
    { name: "Japan", lat: 35.68, lng: 139.76, dialogue: "I'm from Japan. I'm Japanese.", translation: "Soy de Jap√≥n. Soy japon√©s/a." },
    { name: "USA", lat: 38.9, lng: -77.03, dialogue: "I'm from the USA. I'm American.", translation: "Soy de Estados Unidos. Soy estadounidense." },
    { name: "Mexico", lat: 19.43, lng: -99.13, dialogue: "I'm from Mexico. I'm Mexican.", translation: "Soy de M√©xico. Soy mexicano/a." },
    { name: "Canada", lat: 45.42, lng: -75.69, dialogue: "I'm from Canada. I'm Canadian.", translation: "Soy de Canad√°. Soy canadiense." },
    { name: "Brazil", lat: -15.79, lng: -47.88, dialogue: "I'm from Brazil. I'm Brazilian.", translation: "Soy de Brasil. Soy brasile√±o/a." },
    { name: "Argentina", lat: -34.6, lng: -58.38, dialogue: "I'm from Argentina. I'm Argentinian.", translation: "Soy de Argentina. Soy argentino/a." },
    { name: "Chile", lat: -33.45, lng: -70.66, dialogue: "I'm from Chile. I'm Chilean.", translation: "Soy de Chile. Soy chileno/a." },
    { name: "Peru", lat: -12.04, lng: -77.03, dialogue: "I'm from Peru. I'm Peruvian.", translation: "Soy de Per√∫. Soy peruano/a." },
    { name: "Colombia", lat: 4.71, lng: -74.07, dialogue: "I'm from Colombia. I'm Colombian.", translation: "Soy de Colombia. Soy colombiano/a." },
    { name: "Spain", lat: 40.42, lng: -3.7, dialogue: "I'm from Spain. I'm Spanish.", translation: "Soy de Espa√±a. Soy espa√±ol/a." },
    { name: "France", lat: 48.85, lng: 2.35, dialogue: "I'm from France. I'm French.", translation: "Soy de Francia. Soy franc√©s/a." },
    { name: "Germany", lat: 52.52, lng: 13.4, dialogue: "I'm from Germany. I'm German.", translation: "Soy de Alemania. Soy alem√°n/a." },
    { name: "Italy", lat: 41.9, lng: 12.5, dialogue: "I'm from Italy. I'm Italian.", translation: "Soy de Italia. Soy italiano/a." },
    { name: "United Kingdom", lat: 51.5, lng: -0.12, dialogue: "I'm from the UK. I'm British.", translation: "Soy del Reino Unido. Soy brit√°nico/a." },
    { name: "Ireland", lat: 53.35, lng: -6.26, dialogue: "I'm from Ireland. I'm Irish.", translation: "Soy de Irlanda. Soy irland√©s/a." },
    { name: "Portugal", lat: 38.72, lng: -9.14, dialogue: "I'm from Portugal. I'm Portuguese.", translation: "Soy de Portugal. Soy portugu√©s/a." },
    { name: "Russia", lat: 55.75, lng: 37.62, dialogue: "I'm from Russia. I'm Russian.", translation: "Soy de Rusia. Soy ruso/a." },
    { name: "China", lat: 39.9, lng: 116.4, dialogue: "I'm from China. I'm Chinese.", translation: "Soy de China. Soy chino/a." },
    { name: "India", lat: 28.61, lng: 77.2, dialogue: "I'm from India. I'm Indian.", translation: "Soy de India. Soy indio/a." },
    { name: "South Korea", lat: 37.57, lng: 126.98, dialogue: "I'm from South Korea. I'm Korean.", translation: "Soy de Corea del Sur. Soy coreano/a." },
    { name: "Australia", lat: -35.28, lng: 149.13, dialogue: "I'm from Australia. I'm Australian.", translation: "Soy de Australia. Soy australiano/a." },
    { name: "New Zealand", lat: -41.29, lng: 174.78, dialogue: "I'm from New Zealand. I'm Kiwi.", translation: "Soy de Nueva Zelanda. Soy neozeland√©s/a." },
    { name: "South Africa", lat: -25.75, lng: 28.19, dialogue: "I'm from South Africa. I'm South African.", translation: "Soy de Sud√°frica. Soy sudafricano/a." },
    { name: "Egypt", lat: 30.04, lng: 31.24, dialogue: "I'm from Egypt. I'm Egyptian.", translation: "Soy de Egipto. Soy egipcio/a." },
    { name: "Nigeria", lat: 9.05, lng: 7.49, dialogue: "I'm from Nigeria. I'm Nigerian.", translation: "Soy de Nigeria. Soy nigeriano/a." },
    { name: "Kenya", lat: -1.29, lng: 36.82, dialogue: "I'm from Kenya. I'm Kenyan.", translation: "Soy de Kenia. Soy keniata." },
    { name: "Turkey", lat: 39.93, lng: 32.86, dialogue: "I'm from Turkey. I'm Turkish.", translation: "Soy de Turqu√≠a. Soy turco/a." },
    { name: "Greece", lat: 37.98, lng: 23.72, dialogue: "I'm from Greece. I'm Greek.", translation: "Soy de Grecia. Soy griego/a." },
    { name: "Sweden", lat: 59.33, lng: 18.06, dialogue: "I'm from Sweden. I'm Swedish.", translation: "Soy de Suecia. Soy sueco/a." },
    { name: "Norway", lat: 59.91, lng: 10.75, dialogue: "I'm from Norway. I'm Norwegian.", translation: "Soy de Noruega. Soy noruego/a." },
    { name: "Finland", lat: 60.17, lng: 24.94, dialogue: "I'm from Finland. I'm Finnish.", translation: "Soy de Finlandia. Soy finland√©s/a." },
    { name: "Denmark", lat: 55.68, lng: 12.57, dialogue: "I'm from Denmark. I'm Danish.", translation: "Soy de Dinamarca. Soy dan√©s/a." },
    { name: "Netherlands", lat: 52.37, lng: 4.9, dialogue: "I'm from the Netherlands. I'm Dutch.", translation: "Soy de Pa√≠ses Bajos. Soy holand√©s/a." },
    { name: "Belgium", lat: 50.85, lng: 4.35, dialogue: "I'm from Belgium. I'm Belgian.", translation: "Soy de B√©lgica. Soy belga." },
    { name: "Switzerland", lat: 46.95, lng: 7.44, dialogue: "I'm from Switzerland. I'm Swiss.", translation: "Soy de Suiza. Soy suizo/a." },
    { name: "Austria", lat: 48.2, lng: 16.37, dialogue: "I'm from Austria. I'm Austrian.", translation: "Soy de Austria. Soy austr√≠aco/a." },
    { name: "Poland", lat: 52.23, lng: 21.01, dialogue: "I'm from Poland. I'm Polish.", translation: "Soy de Polonia. Soy polaco/a." },
    { name: "Czech Republic", lat: 50.08, lng: 14.43, dialogue: "I'm from the Czech Republic. I'm Czech.", translation: "Soy de Rep√∫blica Checa. Soy checo/a." },
    { name: "Hungary", lat: 47.5, lng: 19.04, dialogue: "I'm from Hungary. I'm Hungarian.", translation: "Soy de Hungr√≠a. Soy h√∫ngaro/a." }
  ];

let selectedDialogue = null;
countries.forEach(c=>{
  L.marker([c.lat,c.lng]).addTo(map).bindPopup(`<b>${c.name}</b>`).on('click',()=>{
    const dialogueEl = document.getElementById('dialogue');
    if(!selectedDialogue){
      selectedDialogue=document.createElement('span');
      selectedDialogue.className='translatable';
      dialogueEl.innerHTML='';
      dialogueEl.appendChild(selectedDialogue);
    }
    selectedDialogue.dataset.original=c.dialogue;
    selectedDialogue.dataset.translation=c.translation;
    selectedDialogue.textContent=c.dialogue;
    speak(c.dialogue);
  });
});

// Traducci√≥n espec√≠fica de la secci√≥n del mapa
const sectionBtn=document.querySelector('#section5 .translate-section-btn');
if(sectionBtn){
  sectionBtn.addEventListener('click',()=>{
    document.querySelectorAll('#section5 .translatable').forEach(el=>{
      if(!el.dataset.original) return;
      el.textContent=el.textContent===el.dataset.original ? el.dataset.translation : el.dataset.original;
    });
  });
}

// Evitar primer playback en blanco
window.onload = () => { speechSynthesis.getVoices(); };

let practiceTimeouts = [];

function practiceNumbers(start=1, end=10) {
  practiceTimeouts.forEach(t => clearTimeout(t));
  practiceTimeouts = [];
  window.speechSynthesis.cancel();
  
  const text = numbers.slice(start-1, end).join(", ");
  speak(text);
}
</script>

<script src="../auth.js"></script>
</body>
</html>
